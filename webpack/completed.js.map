{"version":3,"sources":["completed.es6.js"],"names":[],"mappings":";;;;;QASgB,K,GAAA,K;;AAThB;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAM,WAAW,eAAK,IAAL,CAAU,SAAV,EAAqB,4BAArB,CAAjB;AAAA,IACE,YAAY,uDADd;AAAA,IAEE,OAAO,4BAFT;;AAIO,SAAS,KAAT,CAAe,QAAf,EAAyB;;AAE9B,MAAM,UAAU,SAAV,OAAU,GAAM;AACpB,QAAM,OAAO;AACT,YAAM,MADG;AAET,YAAM,iBAFG;AAGT,YAAM,IAHG;AAIT,WAAK,aAAG,YAAH,CAAgB,gCAAhB,CAJI;AAKT,gBAAU;AALD,KAAb;AAAA,QAOE,WAAW,CACT,kCADS,EAET,+CAFS,EAGT,mCAHS,CAPb;;AAaA,2BAAK,SAAS,IAAT,CAAc,GAAd,CAAL,EAAyB,IAAzB,EACG,IADH,CACQ,QAAQ,MADhB;AAED,GAhBD;;AAkBA,MAAI,gBAAJ;AACA,OAAK,OAAL,CAAa;AACX,UAAM,iBADK;AAEX,cAAU,MAFC;AAGX,gBAAY,eAHD;AAIX,UAAM,IAJK;AAKX,gBAAY,aAAG,YAAH,CAAgB,gCAAhB;AALD,GAAb,EAMG,IANH,CAMQ,mBAAW;AACjB,YAAQ,GAAR,CAAY,iCAAZ;AACA,cAAU,OAAV;AACD,GATD;AAUA,WAAS,MAAT,CAAgB,MAAhB,EAAwB,YAAY;AAClC,YAAQ,GAAR,sBAA+B,QAA/B;AACA,SAAK,GAAL,CAAS,QAAT,EAAmB,SAAnB,EAA8B,OAA9B,EACG,IADH,CACQ,YAAM;AACV,cAAQ,GAAR;AACA,cAAQ,GAAR;AACA;AACD,KALH;AAMD,GARD;AASD","file":"completed.js","sourcesContent":["import PromiseSftp from 'sftp-promises'\nimport path from 'path'\nimport exec from 'ssh-exec'\nimport fs from 'fs'\n\nconst localDir = path.join(__dirname, '../server/app-build.dev.js'),\n  remoteDir = '/home/phong/api.v1/vaithuhay/server/app-build.prod.js',\n  sftp = new PromiseSftp();\n\nexport function apply(compiler) {\n\n  const restart = () => {\n    const host = {\n        user: 'root',\n        host: 'hungphongbk.com',\n        port: 22,\n        key: fs.readFileSync('/Users/hungphongbk/.ssh/id_rsa'),\n        password: 'hungPhong1*!@'\n      },\n      commands = [\n        'cd /home/phong/api.v1/vaithuhay/',\n        'cp server/app-build.prod.js server/app.dev.js',\n        'PORT=8090 forever restart bin/www'\n      ];\n\n    exec(commands.join(';'), host)\n      .pipe(process.stdout)\n  };\n\n  let connect;\n  sftp.session({\n    host: 'hungphongbk.com',\n    username: 'root',\n    passphrase: 'hungPhong1*!@',\n    port: 22,\n    privateKey: fs.readFileSync('/Users/hungphongbk/.ssh/id_rsa')\n  }).then(session => {\n    console.log('connected to hungphongbk server')\n    connect = session;\n  });\n  compiler.plugin('done', function () {\n    console.log(`Uploading from \"${localDir}\"`);\n    sftp.put(localDir, remoteDir, connect)\n      .then(() => {\n        console.log(`Uploaded. Restarting server...`);\n        connect.end()\n        restart();\n      });\n  })\n}\n"]}
